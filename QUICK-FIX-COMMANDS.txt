╔══════════════════════════════════════════════════════════════╗
║  🔧 Lelink Solar 后台管理系统 - 快速修复命令                    ║
║  复制以下命令，粘贴到Linode服务器终端执行                      ║
╚══════════════════════════════════════════════════════════════╝

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
📋 第一部分：连接到服务器
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

ssh root@172.233.148.191

（输入密码后回车）

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
📋 第二部分：执行修复（全部复制粘贴）
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

cd /var/www/lelink-solar-website && \
echo "📍 当前目录: $(pwd)" && \
echo "" && \
echo "💾 备份配置文件..." && \
cp next.config.js next.config.js.backup && \
echo "✅ 备份完成" && \
echo "" && \
echo "🔧 修改配置..." && \
sed -i "s/output: 'export',/\/\/ output: 'export', \/\/ 后台需要API/" next.config.js && \
sed -i "s/trailingSlash: true,/\/\/ trailingSlash: true,/" next.config.js && \
echo "✅ 配置已修改" && \
echo "" && \
echo "🧹 清理旧构建..." && \
rm -rf .next out && \
echo "✅ 清理完成" && \
echo "" && \
echo "📦 安装依赖..." && \
npm install && \
echo "" && \
echo "🏗️  开始构建（需要1-3分钟）..." && \
npm run build && \
echo "" && \
echo "🔄 停止旧进程..." && \
pm2 delete all 2>/dev/null || echo "（无旧进程）" && \
echo "" && \
echo "🚀 启动新应用..." && \
pm2 start npm --name "lelink-admin" -- start && \
pm2 save && \
echo "" && \
echo "━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━" && \
echo "🎉 修复完成！" && \
echo "━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━" && \
echo "" && \
echo "📱 访问地址：" && \
echo "   http://172.233.148.191:3000/admin/login" && \
echo "" && \
echo "🔐 登录信息：" && \
echo "   用户名: admin" && \
echo "   密码: admin123" && \
echo "" && \
echo "📊 查看状态：" && \
pm2 status && \
echo "" && \
echo "📝 查看日志（最近20行）：" && \
pm2 logs lelink-admin --lines 20

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
✅ 完成后
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

在浏览器中打开：
http://172.233.148.191:3000/admin/login

使用以下信息登录：
• 用户名：admin
• 密码：admin123

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
🔍 如果遇到问题
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

查看详细日志：
pm2 logs lelink-admin --lines 50

检查应用状态：
pm2 status

重启应用：
pm2 restart lelink-admin

查看端口占用：
netstat -tulpn | grep 3000

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
📚 详细文档
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

完整说明请查看：LINODE-SERVER-FIX.md

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
⚠️  重要提示
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

1. 首次登录后请立即修改默认密码！
2. 前台网站（lelinksolar.com）不受影响，继续正常运行
3. 这是长期使用方案，无需再次修复

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

祝您使用愉快！🚀

