# ğŸ¯ åˆ†ç¦»éƒ¨ç½²å®Œæ•´æŒ‡å—

## ğŸ“‹ éƒ¨ç½²æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    å‰å°ç½‘ç«™ (é™æ€)                             â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚  å¹³å°: GitHub Pages                                          â”‚
â”‚  åŸŸå: https://lelinksolar.com                               â”‚
â”‚  å†…å®¹: é¦–é¡µã€äº§å“é¡µã€FAQã€è”ç³»æˆ‘ä»¬ç­‰å±•ç¤ºé¡µé¢                    â”‚
â”‚  é…ç½®: output: 'export' (é™æ€å¯¼å‡º)                           â”‚
â”‚  ç‰¹ç‚¹: å¿«é€Ÿã€å…è´¹ã€CDNåŠ é€Ÿ                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    åå°ç³»ç»Ÿ (åŠ¨æ€)                             â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚  å¹³å°: Linode VPS                                            â”‚
â”‚  åŸŸå: http://172.233.148.191:3000                          â”‚
â”‚       æˆ– https://admin.lelinksolar.com (é…ç½®å)              â”‚
â”‚  å†…å®¹: ç®¡ç†ç³»ç»Ÿã€APIæ¥å£                                       â”‚
â”‚  é…ç½®: æ ‡å‡† Next.js (æ”¯æŒ API Routes)                        â”‚
â”‚  ç‰¹ç‚¹: åŠ¨æ€ã€å¯æ‰©å±•ã€å®Œæ•´åŠŸèƒ½                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸš€ å¿«é€Ÿéƒ¨ç½²ï¼ˆ3æ­¥å®Œæˆï¼‰

### å‡†å¤‡å·¥ä½œ

ç¡®ä¿æ‚¨æœ‰ï¼š
- âœ… LinodeæœåŠ¡å™¨è®¿é—®æƒé™ï¼ˆIP: 172.233.148.191ï¼‰
- âœ… SSHå¯†é’¥å·²é…ç½®
- âœ… Gitä»“åº“å·²æ›´æ–°

### æ–¹æ³•1: ä½¿ç”¨è‡ªåŠ¨éƒ¨ç½²è„šæœ¬ â­

```bash
# åœ¨æœ¬åœ°é¡¹ç›®ç›®å½•è¿è¡Œ
./deploy-admin-to-linode.sh
```

è„šæœ¬ä¼šè‡ªåŠ¨ï¼š
1. è¿æ¥åˆ°LinodeæœåŠ¡å™¨
2. å…‹éš†é¡¹ç›®ä»£ç 
3. é…ç½®åå°ç³»ç»Ÿ
4. å®‰è£…ä¾èµ–å¹¶æ„å»º
5. å¯åŠ¨PM2è¿›ç¨‹

**å®Œæˆåè®¿é—®**: http://172.233.148.191:3000/admin/login

### æ–¹æ³•2: æ‰‹åŠ¨éƒ¨ç½²

å¦‚æœè‡ªåŠ¨è„šæœ¬å¤±è´¥ï¼Œå¯ä»¥æ‰‹åŠ¨æ‰§è¡Œï¼š

```bash
# 1. è¿æ¥åˆ°æœåŠ¡å™¨
ssh root@172.233.148.191

# 2. åˆ›å»ºé¡¹ç›®ç›®å½•
cd /var/www
git clone https://github.com/charlespty/lelink-solar-website.git admin-lelink-solar
cd admin-lelink-solar

# 3. é…ç½®ç³»ç»Ÿï¼ˆä½¿ç”¨åå°ä¸“ç”¨é…ç½®ï¼‰
cp next.config.admin.js next.config.js

# 4. å®‰è£…ä¾èµ–
npm install

# 5. æ„å»ºé¡¹ç›®
npm run build

# 6. å¯åŠ¨æœåŠ¡
pm2 start npm --name "lelink-admin" -- start
pm2 save
pm2 startup
```

---

## ğŸ“ é…ç½®æ–‡ä»¶è¯´æ˜

### å‰å°é…ç½® (next.config.js) - GitHub Pages

```javascript
const nextConfig = {
  output: 'export',        // âœ… ä¿ç•™ï¼šç”Ÿæˆé™æ€æ–‡ä»¶
  trailingSlash: true,
  basePath: '',
  // ... å…¶ä»–é…ç½®
}
```

### åå°é…ç½® (next.config.admin.js) - Linode VPS

```javascript
const nextConfig = {
  // output: 'export',     // âŒ ç§»é™¤ï¼šéœ€è¦API Routes
  // ... å…¶ä»–é…ç½®ä¿æŒä¸€è‡´
}
```

---

## ğŸ”§ é…ç½®å­åŸŸåï¼ˆå¯é€‰ä½†æ¨èï¼‰

### Step 1: åœ¨GoDaddyæ·»åŠ DNSè®°å½•

ç™»å½• GoDaddy â†’ DNSç®¡ç† â†’ æ·»åŠ è®°å½•ï¼š

```
ç±»å‹: A
åç§°: admin
å€¼: 172.233.148.191
TTL: 600ç§’
```

**ç»“æœ**: `admin.lelinksolar.com` â†’ `172.233.148.191`

### Step 2: åœ¨Linodeé…ç½®Nginx

```bash
ssh root@172.233.148.191

# åˆ›å»ºNginxé…ç½®
sudo nano /etc/nginx/sites-available/admin-lelink-solar
```

æ·»åŠ é…ç½®ï¼š

```nginx
server {
    listen 80;
    listen [::]:80;
    
    server_name admin.lelinksolar.com;
    
    location / {
        proxy_pass http://localhost:3000;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection 'upgrade';
        proxy_set_header Host $host;
        proxy_cache_bypass $http_upgrade;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
        
        # è¶…æ—¶è®¾ç½®
        proxy_connect_timeout 60s;
        proxy_send_timeout 60s;
        proxy_read_timeout 60s;
    }
    
    # é™æ€æ–‡ä»¶ç›´æ¥æœåŠ¡
    location /_next/static {
        proxy_pass http://localhost:3000;
        proxy_cache_valid 200 365d;
        add_header Cache-Control "public, immutable";
    }
}
```

```bash
# å¯ç”¨ç«™ç‚¹
sudo ln -s /etc/nginx/sites-available/admin-lelink-solar /etc/nginx/sites-enabled/

# æµ‹è¯•é…ç½®
sudo nginx -t

# é‡å¯Nginx
sudo systemctl reload nginx
```

### Step 3: é…ç½®SSLè¯ä¹¦

```bash
# å®‰è£…Certbotï¼ˆå¦‚æœæœªå®‰è£…ï¼‰
sudo apt install certbot python3-certbot-nginx -y

# è·å–SSLè¯ä¹¦
sudo certbot --nginx -d admin.lelinksolar.com

# æµ‹è¯•è‡ªåŠ¨ç»­æœŸ
sudo certbot renew --dry-run
```

**å®Œæˆåè®¿é—®**: https://admin.lelinksolar.com/admin/login ğŸ”’

---

## ğŸ”’ å®‰å…¨é…ç½®ï¼ˆé‡è¦ï¼‰

### 1. ä¿®æ”¹é»˜è®¤å¯†ç 

é¦–æ¬¡ç™»å½•åç«‹å³ä¿®æ”¹ï¼š
1. ç™»å½•åå°
2. è¿›å…¥"ç³»ç»Ÿè®¾ç½®"
3. ä¿®æ”¹å¯†ç 

### 2. é…ç½®ç¯å¢ƒå˜é‡

```bash
ssh root@172.233.148.191
cd /var/www/admin-lelink-solar

# åˆ›å»ºç¯å¢ƒå˜é‡æ–‡ä»¶
nano .env.local
```

æ·»åŠ å†…å®¹ï¼š

```env
# JWTå¯†é’¥ï¼ˆå¿…é¡»ä¿®æ”¹ï¼‰
JWT_SECRET=your-super-secret-key-at-least-32-characters-long

# APIåŸºç¡€URL
NEXT_PUBLIC_API_URL=https://admin.lelinksolar.com

# ç¯å¢ƒ
NODE_ENV=production
```

ç”Ÿæˆå¼ºå¯†é’¥ï¼š
```bash
openssl rand -hex 32
```

### 3. é…ç½®é˜²ç«å¢™

```bash
# å¦‚æœä½¿ç”¨å­åŸŸåï¼Œå¯ä»¥å…³é—­3000ç«¯å£çš„å¤–éƒ¨è®¿é—®
sudo ufw deny 3000/tcp

# åªå…è®¸Nginxè®¿é—®3000ç«¯å£ï¼ˆæœ¬åœ°ï¼‰
# ç«¯å£3000åªç›‘å¬ localhost
```

ä¿®æ”¹PM2é…ç½®ï¼š
```bash
nano ecosystem.config.js
```

```javascript
module.exports = {
  apps: [{
    name: 'lelink-admin',
    script: 'npm',
    args: 'start',
    env: {
      NODE_ENV: 'production',
      PORT: 3000,
      HOST: '127.0.0.1'  // åªç›‘å¬æœ¬åœ°
    }
  }]
}
```

---

## ğŸ“Š ç®¡ç†å’Œç›‘æ§

### PM2 å¸¸ç”¨å‘½ä»¤

```bash
# æŸ¥çœ‹çŠ¶æ€
pm2 status

# æŸ¥çœ‹æ—¥å¿—
pm2 logs lelink-admin

# å®æ—¶æ—¥å¿—
pm2 logs lelink-admin --lines 100

# é‡å¯åº”ç”¨
pm2 restart lelink-admin

# åœæ­¢åº”ç”¨
pm2 stop lelink-admin

# åˆ é™¤åº”ç”¨
pm2 delete lelink-admin

# ç›‘æ§
pm2 monit
```

### Nginx å¸¸ç”¨å‘½ä»¤

```bash
# æµ‹è¯•é…ç½®
sudo nginx -t

# é‡å¯
sudo systemctl restart nginx

# é‡è½½é…ç½®
sudo systemctl reload nginx

# æŸ¥çœ‹çŠ¶æ€
sudo systemctl status nginx

# æŸ¥çœ‹é”™è¯¯æ—¥å¿—
sudo tail -f /var/log/nginx/error.log

# æŸ¥çœ‹è®¿é—®æ—¥å¿—
sudo tail -f /var/log/nginx/access.log
```

---

## ğŸ”„ æ›´æ–°éƒ¨ç½²

### æ›´æ–°åå°ä»£ç 

```bash
# æ–¹æ³•1: ä½¿ç”¨éƒ¨ç½²è„šæœ¬
./deploy-admin-to-linode.sh

# æ–¹æ³•2: æ‰‹åŠ¨æ›´æ–°
ssh root@172.233.148.191
cd /var/www/admin-lelink-solar
git pull
npm install
npm run build
pm2 restart lelink-admin
```

### æ›´æ–°å‰å°ä»£ç ï¼ˆGitHub Pagesï¼‰

```bash
# åœ¨æœ¬åœ°
git add .
git commit -m "Update frontend"
git push

# GitHub Actions ä¼šè‡ªåŠ¨éƒ¨ç½²
```

---

## âœ… éªŒè¯æ¸…å•

éƒ¨ç½²å®Œæˆåï¼Œè¯·éªŒè¯ï¼š

### å‰å°ç½‘ç«™
- [ ] å¯ä»¥è®¿é—® https://lelinksolar.com
- [ ] é¦–é¡µæ­£å¸¸æ˜¾ç¤º
- [ ] äº§å“é¡µé¢æ­£å¸¸
- [ ] å›¾ç‰‡æ­£å¸¸åŠ è½½
- [ ] æ‰€æœ‰é“¾æ¥æœ‰æ•ˆ
- [ ] ç§»åŠ¨ç«¯æ˜¾ç¤ºæ­£å¸¸

### åå°ç³»ç»Ÿ
- [ ] å¯ä»¥è®¿é—®ç™»å½•é¡µé¢
  - http://172.233.148.191:3000/admin/login
  - æˆ– https://admin.lelinksolar.com/admin/login
- [ ] å¯ä»¥æˆåŠŸç™»å½•
- [ ] ä»ªè¡¨æ¿æ­£å¸¸æ˜¾ç¤º
- [ ] äº§å“ç®¡ç†åŠŸèƒ½æ­£å¸¸
- [ ] å†…å®¹ç®¡ç†åŠŸèƒ½æ­£å¸¸
- [ ] è¯¢ä»·ç®¡ç†åŠŸèƒ½æ­£å¸¸
- [ ] å›¾ç‰‡ä¸Šä¼ åŠŸèƒ½æ­£å¸¸
- [ ] APIæ¥å£å“åº”æ­£å¸¸

### æ€§èƒ½å’Œå®‰å…¨
- [ ] é¡µé¢åŠ è½½é€Ÿåº¦ < 3ç§’
- [ ] SSLè¯ä¹¦æœ‰æ•ˆï¼ˆå¦‚é…ç½®ï¼‰
- [ ] é˜²ç«å¢™è§„åˆ™æ­£ç¡®
- [ ] é»˜è®¤å¯†ç å·²ä¿®æ”¹
- [ ] ç¯å¢ƒå˜é‡å·²é…ç½®

---

## ğŸ› æ•…éšœæ’æŸ¥

### é—®é¢˜1: æ— æ³•è®¿é—®åå°

**æ£€æŸ¥é¡¹**:
```bash
# 1. PM2çŠ¶æ€
pm2 status
pm2 logs lelink-admin

# 2. ç«¯å£å ç”¨
netstat -tulpn | grep 3000

# 3. é˜²ç«å¢™
sudo ufw status

# 4. NginxçŠ¶æ€ï¼ˆå¦‚ä½¿ç”¨å­åŸŸåï¼‰
sudo systemctl status nginx
sudo nginx -t
```

### é—®é¢˜2: 502 Bad Gateway

**åŸå› **: Nginxæ— æ³•è¿æ¥åˆ°Node.jsåº”ç”¨

**è§£å†³**:
```bash
# é‡å¯PM2åº”ç”¨
pm2 restart lelink-admin

# æ£€æŸ¥ç«¯å£
netstat -tulpn | grep 3000

# é‡å¯Nginx
sudo systemctl restart nginx
```

### é—®é¢˜3: APIè¯·æ±‚å¤±è´¥

**æ£€æŸ¥**:
```bash
# æŸ¥çœ‹åº”ç”¨æ—¥å¿—
pm2 logs lelink-admin --lines 50

# æ£€æŸ¥ç¯å¢ƒå˜é‡
cat /var/www/admin-lelink-solar/.env.local

# é‡å¯åº”ç”¨
pm2 restart lelink-admin
```

### é—®é¢˜4: æ„å»ºå¤±è´¥

**åŸå› **: ä¾èµ–é—®é¢˜æˆ–é…ç½®é”™è¯¯

**è§£å†³**:
```bash
# æ¸…ç†å¹¶é‡æ–°å®‰è£…
rm -rf node_modules package-lock.json
npm install

# æ¸…ç†æ„å»ºç¼“å­˜
rm -rf .next

# é‡æ–°æ„å»º
npm run build
```

---

## ğŸ“ˆ æ€§èƒ½ä¼˜åŒ–å»ºè®®

### 1. å¯ç”¨ Gzip å‹ç¼©ï¼ˆNginxï¼‰

```nginx
gzip on;
gzip_vary on;
gzip_min_length 1024;
gzip_types text/plain text/css text/xml text/javascript application/json application/javascript application/xml+rss;
```

### 2. é…ç½®ç¼“å­˜

```nginx
location /_next/static {
    proxy_pass http://localhost:3000;
    expires 365d;
    add_header Cache-Control "public, immutable";
}

location /images {
    proxy_pass http://localhost:3000;
    expires 30d;
    add_header Cache-Control "public";
}
```

### 3. æ•°æ®åº“è¿æ¥æ± 

å½“è¿æ¥çœŸå®æ•°æ®åº“æ—¶ï¼Œé…ç½®è¿æ¥æ± ï¼š

```javascript
// MongoDBç¤ºä¾‹
const mongoose = require('mongoose');
mongoose.connect(uri, {
  maxPoolSize: 10,
  minPoolSize: 5,
});
```

---

## ğŸ“ æŠ€æœ¯æ”¯æŒ

### æ—¥å¿—ä½ç½®

```
PM2æ—¥å¿—: ~/.pm2/logs/
Nginxæ—¥å¿—: /var/log/nginx/
ç³»ç»Ÿæ—¥å¿—: /var/log/syslog
```

### è”ç³»æ–¹å¼

- ğŸ“§ é‚®ç®±: tech@lelinksolar.com
- ğŸ’¬ å¾®ä¿¡: LelinkSolar
- ğŸ“± ç”µè¯: +86 138 0013 8000

---

## ğŸ‰ å®Œæˆï¼

æ‚¨çš„Lelink Solarç½‘ç«™ç°åœ¨é‡‡ç”¨äº†åˆ†ç¦»éƒ¨ç½²æ¶æ„ï¼š

âœ… **å‰å°**: å¿«é€Ÿã€å¯é çš„é™æ€ç½‘ç«™  
âœ… **åå°**: åŠŸèƒ½å®Œæ•´çš„ç®¡ç†ç³»ç»Ÿ  
âœ… **åˆ†å·¥æ˜ç¡®**: å„å¸å…¶èŒï¼Œæ€§èƒ½æœ€ä¼˜  

ç¥æ‚¨çš„ä¸šåŠ¡è’¸è’¸æ—¥ä¸Šï¼ğŸš€â˜€ï¸

---

*æœ€åæ›´æ–°: 2024å¹´10æœˆ26æ—¥*  
*éƒ¨ç½²æ¶æ„ç‰ˆæœ¬: v2.0 (åˆ†ç¦»éƒ¨ç½²)*

